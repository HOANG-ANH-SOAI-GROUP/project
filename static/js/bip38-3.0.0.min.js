/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/bip38@3.0.0/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var aes=require("browserify-aes"),assert=require("assert"),Buffer=require("safe-buffer").Buffer,bs58check=require("bs58check"),createHash=require("create-hash"),scrypt=require("scryptsy"),xor=require("buffer-xor/inplace"),ecurve=require("ecurve"),curve=ecurve.getCurveByName("secp256k1"),BigInteger=require("bigi"),SCRYPT_PARAMS={N:16384,r:8,p:8},NULL=Buffer.alloc(0);function hash160(e){var r;try{r=createHash("rmd160")}catch(e){r=createHash("ripemd160")}return r.update(createHash("sha256").update(e).digest()).digest()}function hash256(e){return createHash("sha256").update(createHash("sha256").update(e).digest()).digest()}function getAddress(e,r){var t=hash160(curve.G.multiply(e).getEncoded(r)),a=Buffer.allocUnsafe(21);return a.writeUInt8(0,0),t.copy(a,1),bs58check.encode(a)}function encryptRaw(e,r,t,a,c){if(32!==e.length)throw new Error("Invalid private key length");c=c||SCRYPT_PARAMS;var i=getAddress(BigInteger.fromBuffer(e),r),n=Buffer.from(t.normalize("NFC"),"utf8"),s=hash256(i).slice(0,4),u=c.N,f=c.r,d=c.p,o=scrypt(n,s,u,f,d,64,a),l=o.slice(0,32),p=o.slice(32,64),h=xor(l,e),v=aes.createCipheriv("aes-256-ecb",p,NULL);v.setAutoPadding(!1),v.end(h);var y=v.read(),g=Buffer.allocUnsafe(39);return g.writeUInt8(1,0),g.writeUInt8(66,1),g.writeUInt8(r?224:192,2),s.copy(g,3),y.copy(g,7),g}function encrypt(e,r,t,a,c){return bs58check.encode(encryptRaw(e,r,t,a,c))}function decryptRaw(e,r,t,a){if(39!==e.length)throw new Error("Invalid BIP38 data length");if(1!==e.readUInt8(0))throw new Error("Invalid BIP38 prefix");a=a||SCRYPT_PARAMS;var c=e.readUInt8(1);if(67===c)return decryptECMult(e,r,t,a);if(66!==c)throw new Error("Invalid BIP38 type");r=Buffer.from(r.normalize("NFC"),"utf8");var i=e.readUInt8(2),n=224===i;if(!n&&192!==i)throw new Error("Invalid BIP38 compression flag");var s=a.N,u=a.r,f=a.p,d=e.slice(3,7),o=scrypt(r,d,s,u,f,64,t),l=o.slice(0,32),p=o.slice(32,64),h=e.slice(7,39),v=aes.createDecipheriv("aes-256-ecb",p,NULL);v.setAutoPadding(!1),v.end(h);var y=v.read(),g=xor(l,y),B=hash256(getAddress(BigInteger.fromBuffer(g),n)).slice(0,4);return assert.deepStrictEqual(d,B),{privateKey:g,compressed:n}}function decrypt(e,r,t,a){return decryptRaw(bs58check.decode(e),r,t,a)}function decryptECMult(e,r,t,a){r=Buffer.from(r.normalize("NFC"),"utf8"),e=e.slice(1),a=a||SCRYPT_PARAMS;var c=e.readUInt8(1),i=0!=(32&c),n=0!=(4&c);assert.strictEqual(36&c,c,"Invalid private key.");var s,u=e.slice(2,6),f=e.slice(6,14);s=n?f.slice(0,4):f;var d,o=e.slice(14,22),l=e.slice(22,38),p=a.N,h=a.r,v=a.p,y=scrypt(r,s,p,h,v,32,t);n?d=hash256(Buffer.concat([y,f])):d=y;var g=BigInteger.fromBuffer(d),B=curve.G.multiply(g).getEncoded(!0),I=scrypt(B,Buffer.concat([u,f]),1024,1,1,64),w=I.slice(0,32),m=I.slice(32,64),U=aes.createDecipheriv("aes-256-ecb",m,Buffer.alloc(0));U.setAutoPadding(!1),U.end(l);var P=U.read(),R=xor(P,w.slice(16,32)),A=R.slice(8,16),b=aes.createDecipheriv("aes-256-ecb",m,Buffer.alloc(0));b.setAutoPadding(!1),b.write(o),b.end(R.slice(0,8));var C=xor(b.read(),w.slice(0,16)),E=Buffer.concat([C,A],24),q=BigInteger.fromBuffer(hash256(E));return{privateKey:g.multiply(q).mod(curve.n).toBuffer(32),compressed:i}}function verify(e){var r=bs58check.decodeUnsafe(e);if(!r)return!1;if(39!==r.length)return!1;if(1!==r.readUInt8(0))return!1;var t=r.readUInt8(1),a=r.readUInt8(2);if(66===t){if(192!==a&&224!==a)return!1}else{if(67!==t)return!1;if(-37&a)return!1}return!0}module.exports={decrypt:decrypt,decryptECMult:decryptECMult,decryptRaw:decryptRaw,encrypt:encrypt,encryptRaw:encryptRaw,verify:verify};
//# sourceMappingURL=/sm/a6a4681ce17b2085b2510b8dd49f6723910578c666673d709fd6f1ce02082894.map